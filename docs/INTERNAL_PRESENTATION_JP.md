# Vistar-DCM統合プロジェクト
## 社内向けプレゼンテーション

---

## プロジェクト概要

### 目的
MEDIAEDGE DCMをVistar Mediaのプログラマティック広告プラットフォームと統合し、デジタルサイネージでのプログラマティック広告配信を実現

### 背景
- **課題：** 既存のDCMシステムはVistar APIに直接対応していない
- **機会：** プログラマティック広告による未販売枠の収益化
- **アプローチ：** 中間サーバー（ミドルウェア）を開発

---

## 統合アーキテクチャ

```
┌─────────────────────┐
│  Vistar広告サーバー   │
│  (Ad Request API)   │
└──────────┬──────────┘
           │
           ↓ (API通信)
┌─────────────────────┐
│   中間サーバー        │ ← 当社開発
│  (Node.js/Express)  │
│  - API変換           │
│  - HTML生成          │
│  - Creative Cache   │
└──────────┬──────────┘
           │
           ↓ (HTML/URI)
┌─────────────────────┐
│   MEDIAEDGE DCM     │
└──────────┬──────────┘
           │
           ↓ (配信)
┌─────────────────────┐
│  デジタルサイネージ    │
│  プレイヤー           │
└─────────────────────┘
```

---

## 統合方式の選定

### Broadsign Web Redirectパターン
- Vistar公式に承認された実績ある統合方式
- 主要CMS（Broadsign）で採用されている標準アプローチ
- カスタムURL経由で広告を動的に配信

### 当社の強化ポイント
**Creative Caching機能の追加**
- Broadsignにはない独自機能
- より高い安定性とパフォーマンスを実現

---

## 3つの主要機能

### 1. Creative Caching（最重要）
**問題：** Broadsignはリアルタイムダウンロードのみ
→ ネットワーク障害時に広告表示不可

**解決：** 事前キャッシュ機能を実装
- 1時間ごとにクリエイティブを自動ダウンロード
- ローカルに保存
- ネットワーク障害時も表示継続

**効果：**
- 表示遅延：5-30秒 → **1-5秒**（キャッシュヒット時）
- 目標：**60秒未満**（Vistar要件：15分未満）
- ネットワーク障害への耐性：**大幅向上**

---

### 2. プレイヤー機種別最適化

**問題：** 各プレイヤーの能力が異なる

| プレイヤー | HTML対応 | HTML内動画 |
|----------|---------|-----------|
| ME-DEC | ✅ | ❌ |
| USDP-R5000/R2200 | ✅ | ✅ |
| USDP-R1000 | ❌ | ❌ |

**解決：** 機種ごとに最適な広告フォーマットをリクエスト

**効果：**
- 各プレイヤーで最適な表示
- 表示エラーの削減

---

### 3. Proof of Play（配信証明）の確実な送信

**重要：** Vistar要件
- 広告表示後**15分以内**にPoP送信必須
- これが収益計上の条件

**実装：**
- HTML onloadイベントで即座送信
- リトライ機能で確実性向上

**目標：**
- 送信タイミング：**5分以内**（要件を大幅にクリア）
- 成功率：**99%以上**

---

## 期待される効果

### 統合品質メトリクス比較

| 指標 | Broadsign | 当社目標 | 改善率 |
|------|----------|---------|--------|
| **配信成功率（Spend Rate）** | 85-90% | **95%+** | +5-10% |
| **表示遅延（Display Time Latency）** | 5-30秒 | **60秒未満** | -67%以上 |
| **キャッシュヒット時の表示遅延** | N/A | **1-5秒** | 新機能 |
| **キャッシュヒット率** | N/A | **85%+** | 新機能 |
| **PoP成功率** | 95%+ | **99%+** | +4% |

**注記：**
- Display Time Latencyは、広告がリクエストされてから実際に表示されるまでの時間
- キャッシュヒット時は1-5秒、キャッシュミス時でも60秒未満を目標
- Vistar要件は15分（900秒）未満

### ビジネス効果
- ✅ **収益機会の増加：** 配信成功率向上により収益最大化
- ✅ **安定性向上：** ネットワーク障害に強いシステム
- ✅ **運用負荷軽減：** 自動配信によるオペレーション削減

---

## 開発スケジュール

### 第1フェーズ（1-2週目）
**目標：** 基本動作の実現
- Ad Request API統合
- シンプルなHTML生成
- 基本的なPoP送信
- **マイルストーン：** 最初の広告表示成功

### 第2フェーズ（3週目）
**目標：** Creative Caching実装
- キャッシュ管理機能
- バックグラウンド更新
- **マイルストーン：** オフライン動作確認

---

### 第3フェーズ（4週目）
**目標：** 全プレイヤー対応
- ME-DEC対応
- USDP-R5000/R2200対応
- USDP-R1000対応
- **マイルストーン：** 全機種で動作確認

### 第4フェーズ（5-6週目）
**目標：** 本番環境準備
- モニタリング機能
- エラーハンドリング
- パフォーマンス最適化
- **マイルストーン：** 認証テスト準備完了

---

## 技術スタック

### 中間サーバー
```
言語：      Node.js 18+
フレームワーク： Express
デプロイ：   Docker
モニタリング： Prometheus + Grafana
```

### 開発ツール
```
バージョン管理： Git / GitHub
CI/CD：       GitHub Actions（予定）
テスト：      Jest
コード品質：   ESLint + Prettier
```

### インフラ
```
開発環境：  ローカル / Docker
Staging：  Vistar Staging環境
本番環境：  未定（要相談）
```

---

## リスクと対策

### リスク1：プレイヤー制約への対応
**リスク：** 各プレイヤーの能力差による表示問題
**対策：**
- 機種別設定の実装
- 段階的なテスト
- Vistarチームへの事前確認

### リスク2：ネットワーク依存
**リスク：** ネットワーク障害時の広告配信停止
**対策：**
- Creative Caching実装
- オフライン耐性の確保
- フォールバック機構

---

### リスク3：Vistar要件の変更
**リスク：** APIや要件の仕様変更
**対策：**
- 公式ドキュメントの定期確認
- Vistarチームとの密な連携
- 柔軟な設計

### リスク4：スケジュール遅延
**リスク：** 予期せぬ技術的課題
**対策：**
- フェーズごとのマイルストーン設定
- 週次進捗確認
- 優先順位の明確化

---

## 現在の状況

### 完了
- ✅ Vistar Mediaとの初期技術相談
- ✅ 統合アプローチの確定
- ✅ Vistarチームからの承認取得
- ✅ GitHubリポジトリ作成
- ✅ プロジェクト基盤構築
- ✅ ドキュメント作成

### 次のアクション
- 📧 Vistar Mediaへ実装計画書送付（今週）
- 👨‍💻 Phase 1開発開始（今週）
- 🧪 Staging環境セットアップ（来週）
- 📞 Vistarチームとの初回テストコール調整（2週間後）

---

## プロジェクト情報

### GitHubリポジトリ
```
https://github.com/miyaichi/vistar-dcm-middleware
```

### ドキュメント
- 統合アプローチ詳細：`docs/INTEGRATION_APPROACH.md`
- アーキテクチャ図：`docs/ARCHITECTURE_DIAGRAMS.md`
- 概要（英語）：`docs/INTEGRATION_SUMMARY.md`
- 概要（日本語）：`docs/INTEGRATION_SUMMARY_JP.md`

---

## Q&A

### Q1: なぜ中間サーバーが必要なのか？
**A:** DCM本体はVistar APIに直接対応していないため。中間サーバーでAPIを呼び出し、DCMが理解できる形式（HTML）に変換する必要がある。

### Q2: 他社はどうしているのか？
**A:** Broadsignなどの主要CMSも同様の方式（カスタムURL/Web Redirect）を採用。Vistar公式に承認された標準的なアプローチ。

### Q3: Creative Cachingのメリットは？
**A:** ネットワーク障害時も広告配信継続、キャッシュヒット時の表示速度を1-5秒に短縮、配信成功率5-10%向上。Broadsignにはない当社独自の強化ポイント。

---

### Q4: 開発コストは？
**A:** 主にエンジニアリング工数。外部サービスは基本無料（Vistar API利用料なし）。インフラコストは最小限（Docker環境）。

### Q5: 保守運用は？
**A:** 
- 日常運用：ほぼ自動（キャッシュ更新、広告配信）
- 監視：Prometheusメトリクスで健全性確認
- アップデート：Vistar APIの仕様変更時のみ

### Q6: 本番稼働後の拡張性は？
**A:** 
- プレイヤー台数：スケーラブル（Docker増強で対応）
- 新機能追加：中間サーバーで柔軟に対応可能
- 他DSP連携：設計上可能（別プロジェクト）

---

## まとめ

### プロジェクトのポイント
1. ✅ **実績ある方式**：Vistar公式承認のBroadsignパターン準拠
2. ✅ **独自強化**：Creative Cachingで安定性とパフォーマンス向上
3. ✅ **柔軟な設計**：DCM制約に合わせた最適化
4. ✅ **明確な目標**：95%+ Spend Rate、60秒未満 Display Time Latency
5. ✅ **現実的なスケジュール**：6週間での段階的実装

### 期待される成果
- 📈 **収益向上**：プログラマティック広告による未販売枠の収益化
- 🔧 **運用効率化**：自動配信による人的コスト削減
- 💪 **競争力強化**：業界標準プラットフォームへの対応

---

**プロジェクト資料**
GitHub: https://github.com/miyaichi/vistar-dcm-middleware
